<!DOCTYPE html>
<html>
  <head>
    <title>MAGFest Official Radio Checkout System</title>
    <style type="text/css">
      .error {
        color: #ff0000;
      }

      .message {
        color: #00ff00;
      }

      tr.checked-in {
        background-color: #CAFFD8;
      }

      tr.checked-out {
        background-color: #FFBBBB;
      }

      .headset-yes {
        background: #E1E1FF;
      }
    </style>
  </head>

  <body>
    <h1><a href="/">&larr;</a> {{ name }} Department</h1>

    {% if headsets > 0 %}
    <h2>{{ headsets }} headset{{ '' if headsets == 1 else 's' }} checked out:</h2>
    <form action="/headsetin?page=/dept/{{ name }}" method="post"><div><input type="hidden" name="name" value="{{ name }}"/><input type="submit" value="Return Headset"/>></div></form>
    {% endif %}

    {% if batteries > 0 %}
    <h2>{{ batteries }} batter{{ 'y' if headsets == 1 else 'ies' }} checked out:</h2>
    <form action="/batteryin?page=/dept/{{ name }}" method="post"><div><input type="hidden" name="name" value="{{ name }}"/><input type="submit" value="Return Battery"/>></div></form>
    {% endif %}

    {% if radios > 0 %}
    <h2>{{ radios }} Radio{{ '' if radios == 1 else 's' }} checked out:</h2>
    <table>
        <thead>
        <tr></tr>
        <th>ID</th>
        <th>Status</th>
        <th>Name</th>
        <th>Return</th>
        <tr/>
        </thead>
        <tbody>
        {% for id, checkout in out_radios %}
        <tr>
            <td>{{ id|link('radio') }}</td>
            <td title="{{ checkout['time']|full_date }}">Out {{ checkout['time']|rel_date }}</td>
            <td>{{ checkout['borrower']|link('person') }}</td>
            <td><form action="/checkin?page=/dept/{{ name }}" method="post"><div><input type="hidden" name="id" value="{{ id }}"/><input type="submit" value="Return"/></div></form></td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endif %}

	<h2>Radios: {{ radios }}</h2>
	<h2>Headsets: {{ headsets }}</h2>
	<h2>Batteries: {{ batteries }}</h2>

    <table>
      <thead>
	<tr>
	  <th>Time</th>
	  <th>Action</th>
      <th>Person</th>
	  <th>Item</th>
	</tr>
      </thead>
      <tbody>
	  {% for evt in history|sort(True, attribute='time') %}
      {% if evt['status'] == "CHECKED_IN" %}<tr class="checked-in">{% else %}<tr class="checked-out">{% endif %}
	  <td title="{{ evt['time']|full_date }}">{% if evt['time'] %}{{ evt['time']|rel_date }}{% endif %}</td>
	  <td>{{ {"CHECKED_IN": 'Checked In', "CHECKED_OUT": 'Checked Out', "LOCKED": "Locked"}[evt['status']] }}</td>
	  <td>{{ evt['borrower']|link('person')|default('-', True) }}</td>
	  <td>{% if evt['type'] == 'radio' %}<a href="/radio/{{ evt['id'] }}">Radio {{ evt['id'] }}</a>{% else %}{{ evt['type']|title }}{% endif %}</td>
	</tr>
	{% endfor %}
    </tbody>
  </table>
 </body>
</html>
